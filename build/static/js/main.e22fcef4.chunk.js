(this["webpackJsonpreact-piano-demo"]=this["webpackJsonpreact-piano-demo"]||[]).push([[0],{18:function(e,t,n){e.exports=n(45)},23:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),s=n(13),r=n.n(s),i=(n(23),n(2)),c=n(3),l=n(5),u=n(4),m=n(6);n(24);var d=function(){return o.a.createElement("div",{style:{background:"#333"}},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"text-sm-center text-white py-5"},o.a.createElement("h1",null,"react-piano"),o.a.createElement("p",null,"An interactive piano keyboard for React. Supports custom sounds,",o.a.createElement("br",{className:"d-none d-sm-block"})," touch/click/keyboard events, and fully configurable styling."),o.a.createElement("div",{className:"mt-4"},o.a.createElement("a",{className:"btn btn-outline-light btn-lg",href:"https://github.com/kevinsqi/react-piano"},"View docs on Github")))))};var p=function(e){return o.a.createElement("div",{className:"bg-yellow mt-5 py-5"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"text-center text-secondary"},"Made with"," ",o.a.createElement("span",{role:"img","aria-label":"keyboard emoji"},"\ud83c\udfb5"),"by"," ",o.a.createElement("a",{className:"text-secondary",href:"https://www.kevinqi.com/"},o.a.createElement("strong",null,"@kevinsqi")))))},f=n(7),h=n(14),v=n.n(h),g=n(15),N=n.n(g),b=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,this.props.children({containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight}))}}]),t}(o.a.Component),y=N()()(b),E=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={instrumentList:null},n.loadInstrumentList=function(){fetch("".concat(n.props.hostname,"/").concat(n.props.soundfont,"/names.json")).then((function(e){return e.json()})).then((function(e){n.setState({instrumentList:e})}))},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.loadInstrumentList()}},{key:"render",value:function(){return this.props.render(this.state.instrumentList)}}]),t}(o.a.Component);E.defaultProps={soundfont:"MusyngKite"};var k=E,w=n(11),O=n(16),j=n.n(O),C=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).loadInstrument=function(e){n.setState({instrument:null}),j.a.instrument(n.props.audioContext,e,{format:n.props.format,soundfont:n.props.soundfont,nameToUrl:function(e,t,a){return"".concat(n.props.hostname,"/").concat(t,"/").concat(e,"-").concat(a,".js")}}).then((function(e){n.setState({instrument:e})}))},n.playNote=function(e){n.resumeAudio().then((function(){var t=n.state.instrument.play(e);n.setState({activeAudioNodes:Object.assign({},n.state.activeAudioNodes,Object(w.a)({},e,t))})}))},n.stopNote=function(e){n.resumeAudio().then((function(){n.state.activeAudioNodes[e]&&(n.state.activeAudioNodes[e].stop(),n.setState({activeAudioNodes:Object.assign({},n.state.activeAudioNodes,Object(w.a)({},e,null))}))}))},n.resumeAudio=function(){return"suspended"===n.props.audioContext.state?n.props.audioContext.resume():Promise.resolve()},n.stopAllNotes=function(){n.props.audioContext.resume().then((function(){Object.values(n.state.activeAudioNodes).forEach((function(e){e&&e.stop()})),n.setState({activeAudioNodes:{}})}))},n.state={activeAudioNodes:{},instrument:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.loadInstrument(this.props.instrumentName)}},{key:"componentDidUpdate",value:function(e,t){if(e.instrumentName!==this.props.instrumentName&&this.loadInstrument(this.props.instrumentName),t.instrument!==this.state.instrument){if(!this.props.onLoad)return;this.props.onLoad({playNote:this.playNote,stopNote:this.stopNote,stopAllNotes:this.stopAllNotes})}}},{key:"render",value:function(){return this.props.render?this.props.render({isLoading:!this.state.instrument,playNote:this.playNote,stopNote:this.stopNote,stopAllNotes:this.stopAllNotes}):null}}]),t}(o.a.Component);C.defaultProps={format:"mp3",soundfont:"MusyngKite",instrumentName:"acoustic_grand_piano"};var A=C,x=n(17),I=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){n.props.onChange(e),n.selectRef.current.blur()},n.selectRef=o.a.createRef(),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=(e.onChange,Object(x.a)(e,["children","onChange"]));return o.a.createElement("select",Object.assign({},n,{onChange:this.onChange,ref:this.selectRef}),t)}}]),t}(o.a.Component);function S(e){return o.a.createElement("small",{className:"mb-1 text-muted"},e.children)}var R=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).handleKeyDown=function(e){var t=n.props.config.noteRange.last-n.props.config.noteRange.first+1-n.props.keyboardShortcuts.length;if("ArrowLeft"===e.key){var a=n.props.config.keyboardShortcutOffset-1;a>=0&&n.props.setConfig({keyboardShortcutOffset:a})}else if("ArrowRight"===e.key){var o=n.props.config.keyboardShortcutOffset+1;o<=t&&n.props.setConfig({keyboardShortcutOffset:o})}},n.onChangeFirstNote=function(e){n.props.setConfig({noteRange:{first:parseInt(e.target.value,10),last:n.props.config.noteRange.last}})},n.onChangeLastNote=function(e){n.props.setConfig({noteRange:{first:n.props.config.noteRange.first,last:parseInt(e.target.value,10)}})},n.onChangeInstrument=function(e){n.props.setConfig({instrumentName:e.target.value})},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){var e=f.b.NATURAL_MIDI_NUMBERS.reduce((function(e,t){return e[t]=f.b.getAttributes(t).note,e}),{}),t=this.props.config,n=t.noteRange,a=t.instrumentName;return o.a.createElement("div",{className:"form-row"},o.a.createElement("div",{className:"col-3"},o.a.createElement(S,null,"First note"),o.a.createElement(I,{className:"form-control",onChange:this.onChangeFirstNote,value:n.first},f.b.NATURAL_MIDI_NUMBERS.map((function(t){return o.a.createElement("option",{value:t,disabled:t>=n.last,key:t},e[t])})))),o.a.createElement("div",{className:"col-3"},o.a.createElement(S,null,"Last note"),o.a.createElement(I,{className:"form-control",onChange:this.onChangeLastNote,value:n.last},f.b.NATURAL_MIDI_NUMBERS.map((function(t){return o.a.createElement("option",{value:t,disabled:t<=n.first,key:t},e[t])})))),o.a.createElement("div",{className:"col-6"},o.a.createElement(S,null,"Instrument"),o.a.createElement(I,{className:"form-control",value:a,onChange:this.onChangeInstrument},this.props.instrumentList.map((function(e){return o.a.createElement("option",{value:e,key:e},e)})))),o.a.createElement("div",{className:"col mt-2"},o.a.createElement("small",{className:"text-muted"},"Use ",o.a.createElement("strong",null,"left arrow")," and ",o.a.createElement("strong",null,"right arrow")," to move the keyboard shortcuts around.")))}}]),t}(o.a.Component),L=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={config:{instrumentName:"acoustic_grand_piano",noteRange:{first:f.b.fromNote("c3"),last:f.b.fromNote("f5")},keyboardShortcutOffset:0}},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=f.a.create({firstNote:this.state.config.noteRange.first+this.state.config.keyboardShortcutOffset,lastNote:this.state.config.noteRange.last+this.state.config.keyboardShortcutOffset,keyboardConfig:f.a.HOME_ROW});return o.a.createElement(A,{audioContext:this.props.audioContext,instrumentName:this.state.config.instrumentName,hostname:this.props.soundfontHostname,render:function(n){var a=n.isLoading,s=n.playNote,r=n.stopNote,i=n.stopAllNotes;return o.a.createElement("div",null,o.a.createElement("div",{className:"text-center"},o.a.createElement("p",{className:""},"Try it by clicking, tapping, or using your keyboard:"),o.a.createElement("div",{style:{color:"#777"}},o.a.createElement(v.a,{size:32}))),o.a.createElement("div",{className:"mt-4"},o.a.createElement(y,null,(function(n){var i=n.containerWidth;return o.a.createElement(f.c,{noteRange:e.state.config.noteRange,keyboardShortcuts:t,playNote:s,stopNote:r,disabled:a,width:i})}))),o.a.createElement("div",{className:"row mt-5"},o.a.createElement("div",{className:"col-lg-8 offset-lg-2"},o.a.createElement(k,{hostname:e.props.soundfontHostname,render:function(n){return o.a.createElement(R,{config:e.state.config,setConfig:function(t){e.setState({config:Object.assign({},e.state.config,t)}),i()},instrumentList:n||[e.state.config.instrumentName],keyboardShortcuts:t})}}))))}})}}]),t}(o.a.Component),P=n(8),M=n.n(P),U=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={activeNotesIndex:0,isPlaying:!1,stopAllNotes:function(){return console.warn("stopAllNotes not yet loaded")}},n.setPlaying=function(e){n.setState({isPlaying:e})},n.playbackIntervalFn=null,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e,t){var n=this;t.isPlaying!==this.state.isPlaying&&(this.state.isPlaying?this.playbackIntervalFn=setInterval((function(){n.setState({activeNotesIndex:(n.state.activeNotesIndex+1)%n.props.song.length})}),200):(clearInterval(this.playbackIntervalFn),this.state.stopAllNotes(),this.setState({activeNotesIndex:0})))}},{key:"render",value:function(){var e=this,t={first:f.b.fromNote("c3"),last:f.b.fromNote("f5")};return o.a.createElement("div",null,o.a.createElement("div",{className:"text-center"},o.a.createElement("p",null,"Or try playing it back."),o.a.createElement("div",null,o.a.createElement("button",{className:M()("btn",{"btn-outline-info":!this.state.isPlaying,"btn-outline-danger":this.state.isPlaying}),onClick:function(){return e.setPlaying(!e.state.isPlaying)}},this.state.isPlaying?"Stop":"Start"))),o.a.createElement("div",{className:"mt-4"},o.a.createElement(A,{audioContext:this.props.audioContext,instrumentName:"ocarina",hostname:this.props.soundfontHostname,onLoad:function(t){var n=t.stopAllNotes;return e.setState({stopAllNotes:n})},render:function(n){var a=n.isLoading,s=n.playNote,r=n.stopNote;n.stopAllNotes;return o.a.createElement(y,null,(function(n){var i=n.containerWidth;return o.a.createElement(f.c,{activeNotes:e.state.isPlaying?e.props.song[e.state.activeNotesIndex]:[],noteRange:t,width:i,playNote:s,stopNote:r,disabled:a||!e.state.isPlaying})}))}})))}}]),t}(o.a.Component),D=[[65],[69],[71],[],[65],[69],[71],[],[65],[69],[71],[76],[74],[],[71],[72],[71],[67],[64],[],[],[],[],[62],[64],[67],[64],[],[],[],[],[]],W=(n(44),new(window.AudioContext||window.webkitAudioContext));function _(){return o.a.createElement("div",{className:"text-center"},o.a.createElement("h2",null,"Installation"),o.a.createElement("p",{className:"mt-4"},"Install with yarn or npm:"),o.a.createElement("p",{className:"mt-3"},o.a.createElement("code",{className:"p-2 text-dark bg-yellow"},"yarn add react-piano")),o.a.createElement("div",{className:"mt-5"},o.a.createElement("a",{className:"btn btn-info btn-lg",href:"https://github.com/kevinsqi/react-piano"},"View docs on Github")))}var H=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(d,null),o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row mt-5"},o.a.createElement("div",{className:"col-md-8 offset-md-2"},o.a.createElement(L,{audioContext:W,soundfontHostname:"https://d1pzp51pvbm36p.cloudfront.net"}))),o.a.createElement("hr",{className:"mt-5"}),o.a.createElement("div",{className:"row mt-5"},o.a.createElement("div",{className:"col-md-8 offset-md-2"},o.a.createElement(U,{audioContext:W,soundfontHostname:"https://d1pzp51pvbm36p.cloudfront.net",song:D}))),o.a.createElement("hr",{className:"mt-5"}),o.a.createElement("div",{className:"row mt-5"},o.a.createElement("div",{className:"col"},o.a.createElement(_,null)))),o.a.createElement(p,null))}}]),t}(o.a.Component),T=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function F(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}r.a.render(o.a.createElement(H,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/react-piano",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/react-piano","/service-worker.js");T?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):F(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):F(e)}))}}()}},[[18,1,2]]]);
//# sourceMappingURL=main.e22fcef4.chunk.js.map